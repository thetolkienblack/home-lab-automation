[defaults]
# Basic Configuration
inventory = inventories/production.yml
remote_user = root
timeout = 30
forks = 10
gather_facts = True
gathering = smart
fact_caching = jsonfile
fact_caching_connection = .facts_cache
fact_caching_timeout = 86400

# Security Settings
# SSH Agent forwarding enabled - add your key with: ssh-add ~/.ssh/id_graylock
# Or uncomment to use a specific key file:
# private_key_file = ~/.ssh/id_graylock
vault_password_file = ~/.ansible/ansible_vault_pass

# Modern Plugin Paths (singular forms)
collections_path = ./collections:~/.ansible/collections:/usr/share/ansible/collections
roles_path = ./roles:~/.ansible/roles:/usr/share/ansible/roles
library = ./library
filter_plugins = ./filter_plugins
callback_plugins = ./callback_plugins
action_plugins = ./action_plugins
lookup_plugins = ./lookup_plugins

# Performance Optimizations
pipelining = True
control_path_dir = /tmp/.ansible-cp
control_path = %(directory)s/%%h-%%p-%%r
internal_poll_interval = 0.01

# Output Format - Modern approach
stdout_callback = ansible.builtin.default
bin_ansible_callbacks = True

# Error handling
retry_files_enabled = False
any_errors_fatal = False

# Security
# WARNING: host_key_checking disabled for homelab. Enable for production environments.
host_key_checking = False
interpreter_python = auto_silent

# Disable warnings (optional - remove if you want to see warnings)
deprecation_warnings = False
command_warnings = False
system_warnings = False

# Modern defaults
jinja2_extensions = jinja2.ext.do,jinja2.ext.i18n
nocows = True

# Variables
# Automatically load variables from these paths
# This makes group_vars and host_vars work automatically
vars_plugins_enabled = host_group_vars,community.general.filetree

# Force loading of group_vars and host_vars
enable_plugins = host_group_vars

[ssh_connection]
# SSH Performance and Security
# ForwardAgent=yes enables SSH agent forwarding for key management
ssh_args = -o ControlMaster=auto -o ControlPersist=300s -o ForwardAgent=yes -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ServerAliveCountMax=3
pipelining = True
control_path = /tmp/ansible-ssh-%%h-%%p-%%r
scp_if_ssh = smart
transfer_method = smart
retries = 3

[privilege_escalation]
become = True
become_method = su
become_user = root
become_ask_pass = False

# Galaxy Configuration
[galaxy]
server_list = community_galaxy
cache_dir = ~/.ansible/galaxy_cache
display_progress = True

[galaxy_server.community_galaxy]
url = https://galaxy.ansible.com/
token_path = ~/.ansible/galaxy_token

# Inventory Configuration
[inventory]
enable_plugins = yaml, ini, auto, host_list
cache = True
cache_plugin = memory
cache_timeout = 3600

# Colors (optional)
[colors]
highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

# Diff output
[diff]
always = False
context = 3
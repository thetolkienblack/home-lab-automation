# ======================== Elasticsearch Configuration =========================
# Generated by Ansible - elk_stack role
# ---------------------------------- Cluster -----------------------------------
cluster.name: {{ elasticsearch_cluster_name }}
node.name: {{ elasticsearch_node_name }}

# ----------------------------------- Paths ------------------------------------
path.data: {{ elasticsearch_data_dir }}
path.logs: {{ elasticsearch_log_dir }}

# ---------------------------------- Network -----------------------------------
network.host: {{ elasticsearch_network_host }}
http.port: {{ elasticsearch_http_port }}
transport.port: {{ elasticsearch_transport_port }}

# --------------------------------- Discovery ----------------------------------
{% if elk_deployment_mode == 'cluster' %}
discovery.seed_hosts: {{ elasticsearch_cluster_nodes | to_json }}
cluster.initial_master_nodes: {{ elasticsearch_initial_master_nodes | to_json }}
{% else %}
discovery.type: single-node
{% endif %}

# ----------------------------------- Node -------------------------------------
node.roles: [
{%- if elasticsearch_node_master %}master, {% endif -%}
{%- if elasticsearch_node_data %}data, {% endif -%}
{%- if elasticsearch_node_ingest %}ingest{% endif -%}
 ]

# ---------------------------------- Index -------------------------------------
index.number_of_shards: {{ elasticsearch_number_of_shards }}
index.number_of_replicas: {{ elasticsearch_number_of_replicas }}

# ---------------------------------- Security ----------------------------------
{% if elk_security_enabled %}
xpack.security.enabled: true
xpack.security.enrollment.enabled: true

{% if elk_ssl_enabled %}
xpack.security.http.ssl:
  enabled: true
  keystore.path: {{ elk_ssl_certificate_path }}/http.p12

xpack.security.transport.ssl:
  enabled: true
  verification_mode: {{ elk_ssl_verification_mode }}
  keystore.path: {{ elk_ssl_certificate_path }}/transport.p12
  truststore.path: {{ elk_ssl_certificate_path }}/transport.p12
{% endif %}
{% else %}
xpack.security.enabled: false
xpack.security.enrollment.enabled: false
{% endif %}

# ---------------------------------- Various -----------------------------------
action.destructive_requires_name: true

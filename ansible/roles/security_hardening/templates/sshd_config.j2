# SSH Daemon Hardened Configuration
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

# Basic Configuration
Port {{ ssh_port }}
Protocol {{ ssh_protocol }}
ListenAddress 0.0.0.0

# Authentication
PermitRootLogin {{ ssh_permit_root_login }}
PubkeyAuthentication {{ ssh_pubkey_authentication }}
PasswordAuthentication {{ ssh_password_authentication }}
ChallengeResponseAuthentication {{ ssh_challenge_response_auth }}
PermitEmptyPasswords no
UsePAM yes
AuthorizedKeysFile .ssh/authorized_keys

# Session Configuration
MaxAuthTries {{ ssh_max_auth_tries }}
MaxSessions {{ ssh_max_sessions }}
ClientAliveInterval {{ ssh_client_alive_interval }}
ClientAliveCountMax {{ ssh_client_alive_count_max }}

# Security Options  
X11Forwarding {{ ssh_x11_forwarding }}
X11DisplayOffset 10
PrintMotd no
PrintLastLog yes
TCPKeepAlive yes
StrictModes yes
IgnoreUserKnownHosts yes
IgnoreRhosts yes
HostbasedAuthentication no
PermitUserEnvironment no
AllowTcpForwarding no
GatewayPorts no

# Logging
SyslogFacility AUTHPRIV
LogLevel INFO

# SFTP Configuration
Subsystem sftp /usr/lib/openssh/sftp-server -f AUTHPRIV -l INFO
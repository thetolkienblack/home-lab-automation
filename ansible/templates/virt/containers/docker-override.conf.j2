[Service]
# Resource limits only
LimitNOFILE=1048576
LimitNPROC=infinity
LimitCORE=0
TasksMax=infinity

# Accounting
MemoryAccounting=true
CPUAccounting=true
IOAccounting=true

# Restart policy
TimeoutStartSec=0
TimeoutStopSec=120s
Restart=on-failure
StartLimitBurst=3
StartLimitInterval=60s

# Process management
Delegate=yes
KillMode=process

# Logging
StandardOutput=journal
StandardError=journal

# Docker daemon
ExecStart=
ExecStart=/usr/bin/dockerd --containerd=/run/containerd/containerd.sock
ExecReload=/bin/kill -s HUP $MAINPID